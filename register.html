<!DOCTYPE html>

<html>
	<head>
		<meta charset="UTF-8">
		<title>Register</title>
		<link rel="stylesheet" type="text/css" href="./assets/css/register.css" />
		<style>
			html, body{ width: 100%; height: 100%; margin: 0; padding: 0;}
		</style>
		<script>
			
			window.$ = window.jQuery = require('./assets/js/jquery-2.1.4.min.js');
		</script>
		<script src="./assets/js/jparticle.jquery.min.js"></script>
		<script>
			function check()
			{
				var z = document.getElementById("username").value;
				var a = document.getElementById("password").value;
				var b = document.getElementById("confirmpassword").value;
				
				//sends back the error response or creates new account if successful
				var xhttp = new XMLHttpRequest();
				xhttp.open("GET", "http://localhost:3000/register?username=" + z + "&password=" + a + "&confirmpassword=" + b, false);	
				xhttp.send();
				console.log('TESTING XHTTP');
				if (xhttp.responseText === 'uname'){
					document.getElementById("errormessage").innerHTML = 'Username already exists.';
					return false;
				}
				else if (xhttp.responseText === 'pword'){
					document.getElementById("errormessage").innerHTML = 'Passwords must match.';
					return false;
				}
				else{
					var user = JSON.parse(xhttp.responseText);
					ipcRenderer.sendSync('user', user);
					console.log(user);
				}
			}
		</script>
	</head>
	
	<body>
		<div id="background">
			<script>
				$(function(){
					$("body").jParticle({
						particlesNumber: 100,
			            linkDist: 50,
			            disableLinks: false,
			            disableMouse: false,
			            createLinkDist: 200,
			            color: '#92B9BA',
			            width:null,
			            height:null,
			            background: '#fcfcfc',
			            linksWidth: 0.5,
			            particle: 
			            {
			                color: "white",
			                minSize: 1,
			                maxSize: 1,
			                speed: 30
			            }
					});
				});
				</script><script type="text/javascript">
			</script>
		</div>
		<div id="topbar" class="read_success">
			<a href="index.html" id="weathermeister_topbar">G y s t</a>
			<a href="index.html"><img id="logo" src="./assets/images/gyst_homepageicon.png"></a>
		</div>
		
		<div id="signdiv">	
			<div id="register_p_div">
				<p id="registerp">Register</p>
			</div>		
			<form action="calendar.html" onsubmit="return check();" id="submitform">
				<p id="usernametext">Username</p>
				<input type="text" name="username" id="username" class="inputbar" value="">
				<p id="passwordtext">Password</p>
				<input type="password" name="password" id="password" class="inputbar">
				<p id="passwordtext">Confirm Password</p>
				<input type="password" name="confirmpassword" id="confirmpassword" class="inputbar">
				<p id="errormessage"><br></p>
				<input type="submit" name="submit" value="Register" id="registerbutton">
			</form>
		</div>
		
		<div id="logindiv">
			<p id="loginp">Have an account?</p>
			<button id="loginbutton" onclick="location.href='login.html'">login</button>
		</div>
		
	</body>
</html>